#!/usr/bin/env python3

# Author: Ximan Ding (x.ding25@imperial.ac.uk)
# Script: ConcatenateTwoFiles.sh
# Description:
#    This script performs basic analysis on FASTA genome files, including:
#    1. Counting the number of lines in each FASTA file
#    2. Extracting genome sequences (excluding header lines)
#    3. Calculating genome sequence length
#    4. Counting specific motif occurrences (e.g. "ATGC")
#    5. Computing the (A+T)/(G+C) ratio
# Usage: bash ConcatenateTwoFiles.sh
# Date: Oct, 2025

# 1 Count how many lines there are in each FASTA file
# wc=word count, -l indicates that we only count lines. ../data/fasta/*.fasta is to target the FASTA file. 
wc -l ../data/fasta/*.fasta

# 2 Print everything starting from the second line for the E. coli genome
# tail -n +2 means print from second line to the end.
tail -n +2 ../data/fasta/E.coli.fasta

# 3 Count the sequence length of this genome
# tr -d '\n' which removes all newline characters; wc -m counts all characters.
tail -n +2 ../data/fasta/E.coli.fasta | tr -d '\n' | wc -m

# 4 Count the matches of “ATGC” in the E. coli genome
# grep -o "ATGC" searches for every exact match of "ATGC" and prints each match on a new line.
tail -n +2 ../data/fasta/E.coli.fasta | tr -d '\n' | grep -o "ATGC" | wc -l

# 5 Compute the (A+T)/(G+C) ratio
# awk is to count A, T, G, C bases and compute (A+T)/(G+C) ratio.
tail -n +2 ../data/fasta/E.coli.fasta | tr -d '\n' | \
awk '{seq=$0; A=gsub(/A/, "", seq); T=gsub(/T/, "", seq); G=gsub(/G/, "", seq); C=gsub(/C/, "", seq); print (A+T)/(G+C)}'